<world_step
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="../world_step.xsd"
>
  <world_metadata>
    <next_world_step value="../gui-client/data" />
    <elapsed_time value="0" />
    <stepDuration value="0" />
    <counter value="1" />
    <randomization_table>
      <entry value="0" />
      <entry value="8" />
      <entry value="109" />
      <entry value="220" />
      <entry value="222" />
      <entry value="241" />
      <entry value="149" />
      <entry value="107" />
      <entry value="75" />
      <entry value="248" />
      <entry value="254" />
      <entry value="140" />
      <entry value="16" />
      <entry value="66 " />
      <entry value="74" />
      <entry value="21" />
      <entry value="211" />
      <entry value="47" />
      <entry value="80" />
      <entry value="242" />
      <entry value="154" />
      <entry value="27" />
      <entry value="205" />
      <entry value="128" />
      <entry value="161" />
      <entry value="89" />
      <entry value="77" />
      <entry value="36 " />
      <entry value="95" />
      <entry value="110" />
      <entry value="85" />
      <entry value="48" />
      <entry value="212" />
      <entry value="140" />
      <entry value="211" />
      <entry value="249" />
      <entry value="22" />
      <entry value="79" />
      <entry value="200" />
      <entry value="50" />
      <entry value="28" />
      <entry value="188 " />
      <entry value="52" />
      <entry value="140" />
      <entry value="202" />
      <entry value="120" />
      <entry value="68" />
      <entry value="145" />
      <entry value="62" />
      <entry value="70" />
      <entry value="184" />
      <entry value="190" />
      <entry value="91" />
      <entry value="197" />
      <entry value="152" />
      <entry value="224 " />
      <entry value="149" />
      <entry value="104" />
      <entry value="25" />
      <entry value="178" />
      <entry value="252" />
      <entry value="182" />
      <entry value="202" />
      <entry value="182" />
      <entry value="141" />
      <entry value="197" />
      <entry value="4" />
      <entry value="81" />
      <entry value="181" />
      <entry value="242 " />
      <entry value="145" />
      <entry value="42" />
      <entry value="39" />
      <entry value="227" />
      <entry value="156" />
      <entry value="198" />
      <entry value="225" />
      <entry value="193" />
      <entry value="219" />
      <entry value="93" />
      <entry value="122" />
      <entry value="175" />
      <entry value="249" />
      <entry value="0 " />
      <entry value="175" />
      <entry value="143" />
      <entry value="70" />
      <entry value="239" />
      <entry value="46" />
      <entry value="246" />
      <entry value="163" />
      <entry value="53" />
      <entry value="163" />
      <entry value="109" />
      <entry value="168" />
      <entry value="135" />
      <entry value="2" />
      <entry value="235 " />
      <entry value="25" />
      <entry value="92" />
      <entry value="20" />
      <entry value="145" />
      <entry value="138" />
      <entry value="77" />
      <entry value="69" />
      <entry value="166" />
      <entry value="78" />
      <entry value="176" />
      <entry value="173" />
      <entry value="212" />
      <entry value="166" />
      <entry value="113 " />
      <entry value="94" />
      <entry value="161" />
      <entry value="41" />
      <entry value="50" />
      <entry value="239" />
      <entry value="49" />
      <entry value="111" />
      <entry value="164" />
      <entry value="70" />
      <entry value="60" />
      <entry value="2" />
      <entry value="37" />
      <entry value="171" />
      <entry value="75 " />
      <entry value="136" />
      <entry value="156" />
      <entry value="11" />
      <entry value="56" />
      <entry value="42" />
      <entry value="146" />
      <entry value="138" />
      <entry value="229" />
      <entry value="73" />
      <entry value="146" />
      <entry value="77" />
      <entry value="61" />
      <entry value="98" />
      <entry value="196 " />
      <entry value="135" />
      <entry value="106" />
      <entry value="63" />
      <entry value="197" />
      <entry value="195" />
      <entry value="86" />
      <entry value="96" />
      <entry value="203" />
      <entry value="113" />
      <entry value="101" />
      <entry value="170" />
      <entry value="247" />
      <entry value="181" />
      <entry value="113 " />
      <entry value="80" />
      <entry value="250" />
      <entry value="108" />
      <entry value="7" />
      <entry value="255" />
      <entry value="237" />
      <entry value="129" />
      <entry value="226" />
      <entry value="79" />
      <entry value="107" />
      <entry value="112" />
      <entry value="166" />
      <entry value="103" />
      <entry value="241 " />
      <entry value="24" />
      <entry value="223" />
      <entry value="239" />
      <entry value="120" />
      <entry value="198" />
      <entry value="58" />
      <entry value="60" />
      <entry value="82" />
      <entry value="128" />
      <entry value="3" />
      <entry value="184" />
      <entry value="66" />
      <entry value="143" />
      <entry value="224 " />
      <entry value="145" />
      <entry value="224" />
      <entry value="81" />
      <entry value="206" />
      <entry value="163" />
      <entry value="45" />
      <entry value="63" />
      <entry value="90" />
      <entry value="168" />
      <entry value="114" />
      <entry value="59" />
      <entry value="33" />
      <entry value="159" />
      <entry value="95 " />
      <entry value="28" />
      <entry value="139" />
      <entry value="123" />
      <entry value="98" />
      <entry value="125" />
      <entry value="196" />
      <entry value="15" />
      <entry value="70" />
      <entry value="194" />
      <entry value="253" />
      <entry value="54" />
      <entry value="14" />
      <entry value="109" />
      <entry value="226 " />
      <entry value="71" />
      <entry value="17" />
      <entry value="161" />
      <entry value="93" />
      <entry value="186" />
      <entry value="87" />
      <entry value="244" />
      <entry value="138" />
      <entry value="20" />
      <entry value="52" />
      <entry value="123" />
      <entry value="251" />
      <entry value="26" />
      <entry value="36 " />
      <entry value="17" />
      <entry value="46" />
      <entry value="52" />
      <entry value="231" />
      <entry value="232" />
      <entry value="76" />
      <entry value="31" />
      <entry value="221" />
      <entry value="84" />
      <entry value="37" />
      <entry value="216" />
      <entry value="165" />
      <entry value="212" />
      <entry value="106 " />
      <entry value="197" />
      <entry value="242" />
      <entry value="98" />
      <entry value="43" />
      <entry value="39" />
      <entry value="175" />
      <entry value="254" />
      <entry value="145" />
      <entry value="190" />
      <entry value="84" />
      <entry value="118" />
      <entry value="222" />
      <entry value="187" />
      <entry value="136 " />
      <entry value="120" />
      <entry value="163" />
      <entry value="236" />
      <entry value="249" />
    </randomization_table>
  </world_metadata>
  <rule_group id="rule_group_id">
    <property_rule>
      <entry id="health" units="points">
        <person_default initial="10" />
      </entry>
      <entry id="strength" units="points">
        <person_default initial="10" />
      </entry>
      <entry id="gold" units="coins">
        <person_default initial="0">
          <and do="add_dice" value="10" />
        </person_default>
      </entry>
    </property_rule>
    <classification_rule>
      <entry id="alive">
        <property property_rule_ref="health" is="greaterThan">
          <operation initial="0" />
        </property>
      </entry>
      <entry id="dead">
        <property property_rule_ref="health" is="lessThanOrEqual">
          <operation initial="0" />
        </property>
      </entry>
      <entry id="bandit" />
      <entry id="innkeeper"/>
    </classification_rule>
    <action_rule>
      <from_person id="lootGold">
        <mutations>
          <property_mutation property_rule_ref="gold">
            <from participant="target">
              <operation initial="0">
                <add_property property_rule_ref="gold" />
              </operation>
            </from>
          </property_mutation>
        </mutations>
        <on_person>
          <selection>
            <classification classification_rule_ref="dead" />
          </selection>
          <mutations>
            <property_mutation property_rule_ref="gold">
              <from participant="self">
                <operation initial="0">
                  <add_property property_rule_ref="gold" />
                  <and do="multiply" value="-1" />
                </operation>
              </from>
            </property_mutation>
          </mutations>
        </on_person>
      </from_person>
      <from_person id="restAtInn">
        <mutations>
          <property_mutation property_rule_ref="strength">
            <from participant="self">
              <operation initial="10"/>
            </from>
          </property_mutation>
        </mutations>
        <on_person>
          <selection>
            <classification classification_rule_ref="innkeeper" />
          </selection>
        </on_person>
      </from_person>
      <from_person id="globalMeleeAttack">
        <mutations>
          <property_mutation property_rule_ref="strength">
            <from participant="self">
              <operation initial="-1" />
            </from>
          </property_mutation>
        </mutations>
        <on_person>
          <selection>
            <classification classification_rule_ref="alive" />
            <from_person_same_location_graph_node value="true" />
          </selection>
          <mutations>
            <property_mutation property_rule_ref="health">
              <from participant="target">
                <operation initial="0">
                  <add_property property_rule_ref="strength" />
                  <and do="divide" value="2" />
                  <and do="multiply" value="-1" />
                </operation>
              </from>
            </property_mutation>
          </mutations>
        </on_person>
      </from_person>
      <person_to_person id="meleeAttack">
        <test>
          <value target="self">
            <operation initial="0" />
          </value>
          <expected target="self">
            <operation initial="0" />
          </expected>
        </test>
        <property_mutation property_rule_ref="health" on="target">
          <from participant="self">
            <operation initial="0">
              <add_property property_rule_ref="strength" />
              <and do="divide" value="2" />
              <and do="multiply" value="-1" />
            </operation>
          </from>
        </property_mutation>
      </person_to_person>
    </action_rule>

    <link_group_rule_list>
      <link_group_rule id="to_farm" angle="-45" angleMax="45" limit="1">
        <to_option node_rule_ref="farm" distance="2" maxDistance="4" adjacent_depth_limit="1">
          <person_progress_property initial="2" />
        </to_option>
      </link_group_rule>
      <link_group_rule id="to_city" angle="-45" angleMax="45" limit="1">
        <to_option node_rule_ref="city" distance="5" maxDistance="7" adjacent_depth_limit="1">
          <person_progress_property initial="2" />
        </to_option>
      </link_group_rule>
      <link_group_rule id="to_wilderness" angle="-90" angleMax="90" limit="1">
        <to_option node_rule_ref="wilderness" distance="2" maxDistance="4" adjacent_depth_limit="1">
          <distance_to_progress_multiplier initial="1">
            <and do="add" value="1" />
            <and do="add_dice" value="3" />
          </distance_to_progress_multiplier>
          <person_progress_property initial="1" />
        </to_option>
      </link_group_rule>
    </link_group_rule_list>
    <location_graph_rule id="location_graph_rule_id">
      <setup>
        <starting_node node_rule_ref="farm" />
        <necessary_node node_rule_ref="city" min="8" />
      </setup>
      <node_rule id="city">
        <link_group_list>
          <reference link_group_rule_ref="to_farm" />
        </link_group_list>
      </node_rule>
      <node_rule id="farm">
        <link_group_list>
          <reference link_group_rule_ref="to_wilderness" />
          <reference link_group_rule_ref="to_wilderness" />
        </link_group_list>
        <existing_person min="1" max="1">
          <person_selection>
            <classification classification_rule_ref="innkeeper" />
          </person_selection>
        </existing_person>
      </node_rule>
      <node_rule id="wilderness">
        <link_group_list>
        </link_group_list>
        <existing_person min="1" max="4">
          <person_selection>
            <property property_rule_ref="gold">
              <min initial="1" />
              <max initial="10" />
            </property>
            <classification classification_rule_ref="alive" />
          </person_selection>
        </existing_person>
      </node_rule>
    </location_graph_rule>
  </rule_group>
  <data>
    <people>
      <person id="0" name="BillyWithVeryLongName">
        <properties>
          <property property_rule_ref="health" value="10" />
        </properties>
        <classifications>
          <classification classification_rule_ref="alive" />
        </classifications>
      </person>
      <person id="1" name="Bandit">
        <properties>
          <property property_rule_ref="health" value="10" />
        </properties>
        <classifications>
          <classification classification_rule_ref="alive" />
        </classifications>
      </person>
    </people>
    <location>
      <location_graph id="first world">
        <rule location_graph_rule_ref="location_graph_rule_id" />
        <node node_rule_ref="city" id="Capital">
          <position x="0" y="0" />
          <people>
            <person person_id_ref="0" />
            <person person_id_ref="1" />
          </people>
        </node>
      </location_graph>
    </location>
  </data>

</world_step>